<form [formGroup]="purchaseForm" (ngSubmit)="onSubmit()" class="purchase-form">
  <div class="form-header">
    <h2>Create Purchase Order</h2>
  </div>

  <div class="form-row">
    <div class="form-group">
      <label for="supplier">Supplier *</label>
      <select id="supplier" formControlName="supplier" class="form-control" [attr.aria-label]="'Select supplier'" [attr.title]="'Choose a supplier for this purchase order'">
        <option value="">Select Supplier</option>
        <option *ngFor="let supplier of suppliers" [value]="supplier._id">
          {{ supplier.name }}
        </option>
      </select>
    </div>

    <div class="form-group">
      <label for="warehouse">Warehouse *</label>
      <select id="warehouse" formControlName="warehouse" class="form-control" [attr.aria-label]="'Select warehouse'" [attr.title]="'Choose a warehouse for this purchase order'">
        <option value="">Select Warehouse</option>
        <option *ngFor="let warehouse of warehouses" [value]="warehouse._id">
          {{ warehouse.name }}
        </option>
      </select>
    </div>
  </div>

  <div class="items-section">
    <div class="section-header">
      <h3>Items</h3>
      <button type="button" (click)="addItem()" class="btn btn-secondary">
        Add Item
      </button>
    </div>

    <div formArrayName="items" class="items-list">
      <div *ngFor="let item of items.controls; let i = index" [formGroupName]="i" class="item-row">
        <div class="form-group">
          <label [for]="'product-' + i">Product *</label>
          <select [id]="'product-' + i" formControlName="product" class="form-control" [attr.aria-label]="'Select product for item ' + (i + 1)" [attr.title]="'Choose product for item ' + (i + 1)">
            <option value="">Select Product</option>
            <option *ngFor="let product of products" [value]="product._id">
              {{ product.name }} ({{ product.sku }})
            </option>
          </select>
        </div>

        <div class="form-group">
          <label [for]="'quantity-' + i">Quantity *</label>
          <input [id]="'quantity-' + i" type="number" formControlName="quantity" class="form-control" min="1" [attr.aria-label]="'Quantity for item ' + (i + 1)" [attr.title]="'Enter quantity for item ' + (i + 1)" placeholder="Enter quantity">
        </div>

        <div class="form-group">
          <label [for]="'costprice-' + i">Cost Price *</label>
          <input [id]="'costprice-' + i" type="number" formControlName="costprice" class="form-control" min="0" step="0.01" [attr.aria-label]="'Cost price for item ' + (i + 1)" [attr.title]="'Enter cost price for item ' + (i + 1)" placeholder="0.00">
        </div>

        <div class="form-actions">
          <button type="button" (click)="removeItem(i)" class="btn btn-danger" [disabled]="items.length === 1" [attr.aria-label]="'Remove item ' + (i + 1)">
            Remove
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="form-footer">
    <button type="submit" [disabled]="!purchaseForm.valid || loading" class="btn btn-primary">
      {{ loading ? 'Creating...' : 'Create Purchase Order' }}
    </button>
  </div>
</form>
