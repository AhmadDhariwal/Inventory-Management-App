<main class="product-list-container">
  <header class="page-header animate-fade-in">
    <div class="header-content">
      <div class="title-section">
        <h1>Product Management</h1>
        <p class="subtitle">Registry of items, components, and unified catalog assets.</p>
      </div>
      
      <div class="action-buttons">
        <button class="btn-primary" (click)="addProduct()">
          <i class="fas fa-plus"></i>
          New Product
        </button>
        <button class="btn-outline" (click)="refreshList()">
          <i class="fas fa-sync-alt"></i>
          Refresh
        </button>
      </div>
    </div>
  </header>

  <div class="content-section animate-fade-in">
    <div class="toolbar">
      <div class="search-field">
        <i class="fas fa-search search-icon"></i>
        <input 
          type="text" 
          class="search-control" 
          placeholder="Search by name, SKU, or category..."
          [(ngModel)]="searchTerm"
          (input)="onSearch()">
      </div>

      <div class="filter-controls">
        <select class="filter-select" [(ngModel)]="selectedCategory" (change)="onFilter()">
          <option value="">All Categories</option>
          <option *ngFor="let category of categories" [value]="category._id">{{ category.name }}</option>
        </select>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-state">
      <i class="fas fa-circle-notch fa-spin"></i>
      <p>Synchronizing Catalog...</p>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && filteredProducts.length === 0" class="empty-state">
      <i class="fas fa-box-open"></i>
      <h3>No matches found</h3>
      <p>Try adjusting your search or category filters.</p>
    </div>

    <!-- Premium Table -->
    <div *ngIf="!isLoading && filteredProducts.length > 0" class="table-container">
      <div class="table-wrapper">
        <table class="data-table">
          <thead>
            <tr>
              <th class="sortable" (click)="sortBy('sku')">SKU</th>
              <th class="sortable" (click)="sortBy('name')">Asset Name</th>
              <th class="sortable" (click)="sortBy('category')">Classification</th>
              <th class="numeric sortable" (click)="sortBy('cost')">Unit Cost</th>
              <th class="numeric sortable" (click)="sortBy('price')">Target Price</th>
              <th>Status</th>
              <th class="actions-col"></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let product of filteredProducts">
              <td><span class="sku-badge">{{ product.sku }}</span></td>
              <td>
                <div class="product-info">
                  <span style="font-weight: 700">{{ product.name }}</span>
                  <p style="font-size: 0.75rem; color: var(--text-muted); margin: 0">{{ product.description | slice:0:40 }}{{ (product.description?.length || 0) > 40 ? '...' : '' }}</p>
                </div>
              </td>
              <td>{{ product.category?.name || 'Unassigned' }}</td>
              <td class="numeric">{{ product.cost | appCurrency }}</td>
              <td class="numeric">{{ product.price | appCurrency }}</td>
              <td>
                <span class="status-badge" [ngClass]="product.status.toLowerCase()">
                  {{ product.status }}
                </span>
              </td>
              <td class="actions-cell">
                <div class="action-menu">
                  <button class="btn-ghost" (click)="viewProduct(product._id)" title="View Details">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="btn-ghost" (click)="editProduct(product._id)" title="Edit Asset">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button *ngIf="canDelete" class="btn-ghost btn-danger" (click)="deleteProduct(product._id, product.name)" title="Delete Asset">
                    <i class="fas fa-trash-alt"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <app-confirm-modal
    [isVisible]="showDeleteModal"
    title="Confirm Deletion"
    [message]="getDeleteMessage()"
    confirmText="Delete"
    cancelText="Cancel"
    type="warning"
    (confirm)="confirmDelete()"
    (cancel)="cancelDelete()">
  </app-confirm-modal>
</main>
